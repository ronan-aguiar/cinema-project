{% extends 'bilheteria/base.html' %}

{% block content %}
<h1 style="margin-bottom: 30px;">Relatório de Vendas - {{ hoje|date:"d/m/Y" }}</h1>

<!-- Cards de Resumo -->
<div
    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
    <div style="background: #1f1f1f; padding: 25px; border-radius: 8px; border-left: 4px solid #2ecc71;">
        <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Receita Total</div>
        <div style="font-size: 28px; font-weight: bold;">R$ {{ total_receita|stringformat:".2f" }}</div>
    </div>
    <div style="background: #1f1f1f; padding: 25px; border-radius: 8px; border-left: 4px solid var(--primary);">
        <div style="color: #aaa; font-size: 14px; margin-bottom: 5px;">Ingressos Vendidos</div>
        <div style="font-size: 28px; font-weight: bold;">{{ total_ingressos }}</div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr; gap: 30px;">
    <!-- Vendas por Sessão -->
    <div style="background: #1f1f1f; padding: 25px; border-radius: 8px;">
        <h3 style="margin-bottom: 20px;">Vendas Detalhadas por Sessão</h3>
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="text-align: left; border-bottom: 1px solid #333;">
                <tr>
                    <th style="padding: 10px 0;">Horário</th>
                    <th>Filme</th>
                    <th>Inteira</th>
                    <th>Meia</th>
                    <th>Total Qtd</th>
                    <th style="text-align: right;">Total Receita</th>
                </tr>
            </thead>
            <tbody>
                {% for sessao in vendas_por_sessao %}
                <tr style="border-bottom: 1px solid #2a2a2a;">
                    <td style="padding: 12px 0;">{{ sessao.horario|date:"H:i" }}</td>
                    <td style="font-weight: bold;">{{ sessao.filme.titulo }}</td>
                    <td style="color: #2ecc71;">{{ sessao.qtd_inteira }}</td>
                    <td style="color: #f1c40f;">{{ sessao.qtd_meia }}</td>
                    <td>{{ sessao.total_vendas }}</td>
                    <td style="text-align: right; font-weight: bold;">R$ {{ sessao.receita|default:0|stringformat:".2f"
                        }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="padding: 20px 0; color: #666; text-align: center;">Nenhuma sessão registrada
                        para hoje.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Vendas por Vendedor -->
    <div style="background: #1f1f1f; padding: 20px; border-radius: 8px;">
        <h3 style="margin-bottom: 20px;">Desempenho por Vendedor</h3>
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="text-align: left; border-bottom: 1px solid #333;">
                <tr>
                    <th style="padding: 10px 0;">Funcionário</th>
                    <th>Qtd</th>
                    <th style="text-align: right;">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for user in vendas_por_vendedor %}
                <tr style="border-bottom: 1px solid #2a2a2a;">
                    <td style="padding: 12px 0;">{{ user.username }}</td>
                    <td>{{ user.qtd }}</td>
                    <td style="text-align: right;">R$ {{ user.total|stringformat:".2f" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}